/**
  ******************************************************************************
  * @file    bootloader_main.cpp
  * @author  Artem Pisarenko, PMR dept. software team, ONIIP, PJSC
  * @date    19.05.2016
  * @brief   ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалєлаРђџл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалјл▓лѓЛџла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬ила┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлалІла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџл▓РђъРђЊла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалєл▓лѓЛЏл▓лѓРђю ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл┐ЛЌлЁла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалјл▓лѓЛџла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алаРђ░ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬Хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алалЈ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬ила┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалјл▓лѓЛџла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬ила┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлалІла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░.
  *
  ******************************************************************************
 */

#include "../system/platform_hw_map.h"
#include "system/hardware_boot.h"

#include "qmconsolescreen.h"
#include "qmmatrixkeyboard.h"

#include <string>


#if NEW_BOOTLOADER

static const char* saghenTitleStr      = " ** ЛЯТтьЧ-═ **\0";
static const char* bootloaderTitleStr  = " - КЯс­зуэУЖ -\0";
static const char* usbComputerTitleStr = "  USB ╩ЬВ№Ч■Ыт­\0";
static const char* sysBootTitleStr     = "  - ЛУыЫтВьчж -\r\n   - КЯс­зуэУЖ -\r\n\0";

static const char* spaceStr = "                ";
//static const char* spaceStr = "\r\n\0";

static const char* firmwareStr    = " ╬ыьЬРьЯ \r\n\0";
static const char* usbComputerStr = " USB ╩ЬВ№Ч■Ы.\r\n\0";
static const char* sysBootStr     = " ЛУыЫтВ.КЯс­.\r\n\0";

static const char* arrow = "->";
static const char* space = "  ";

static int focus = 0;
static int old_focus = 0;

#define USB_COMPUTER 0
#define FIRMWARE 1
#define SYSTEM_BOOT 2

static bool check_arrows_key_pressed(bool isUp, bool isDown, bool isLeft, bool isRight) // up   -1, down 1
{
    if (isUp)
    {
    	QmMatrixKeyboard upBtn(platformhwMatrixKeyboard);
    	return upBtn.isKeyPressed(platformhwKeyUp);
    }
    else if (isDown)
    {
    	QmMatrixKeyboard downBtn(platformhwMatrixKeyboard);
    	return downBtn.isKeyPressed(platformhwKeyDown);
    }
    else if (isLeft)
    {
    	QmMatrixKeyboard leftBtn(platformhwMatrixKeyboard);
    	return leftBtn.isKeyPressed(platformhwKeyLeft);
    }
    else if (isRight)
    {
    	QmMatrixKeyboard rightBtn(platformhwMatrixKeyboard);
    	return rightBtn.isKeyPressed(platformhwKeyRight);
    }
}

static void drawMenuLine(const char* text)
{
	QmConsoleScreen::oprintf(text);
}

static void drawLine(const char* text)
{
	QmConsoleScreen::oprintf(text);
}

static void drawNewLine(const char* s)
{
		QmConsoleScreen::oputstr(s);
}

static void drawChar(char c)
{
	QmConsoleScreen::oputc(c);
}

static void drawMenu()
{
	const char* lines[3] = {usbComputerStr, firmwareStr, sysBootStr};

	QmConsoleScreen::clearScreen();
	drawNewLine(saghenTitleStr);
	drawNewLine(bootloaderTitleStr);
	drawNewLine(spaceStr);

	for (uint8_t i = 0; i <= 2; i++)
	{
		if (i == focus)
			drawNewLine(arrow);
		else
			drawNewLine(space);

		drawNewLine(lines[i]);

	}
}

static void drawUsbHostScreen()
{
    QmConsoleScreen::clearScreen();
    drawLine(saghenTitleStr);
    drawLine("\n\n\n\0");
	QmConsoleScreen::oprintf(usbComputerTitleStr);
}

static void drawSystemBootScreen()
{
    QmConsoleScreen::clearScreen();
    drawLine(saghenTitleStr);
    drawLine("\n\n\n\0");
	QmConsoleScreen::oprintf(sysBootTitleStr);
}

static void drawFirmwareErrorScreen(uint8_t firmwareNum)
{
    QmConsoleScreen::clearScreen();
    drawLine(saghenTitleStr);
    drawLine("\n\n\0");
    switch (firmwareNum)
    {
    	case 0: QmConsoleScreen::oprintf("     ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n    USB ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n\r\n\     ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n\        ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д    \r\n\    ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д !\0"); break;
    	case 1: QmConsoleScreen::oprintf("     ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n      ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n\r\n\     ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n\        ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д    \r\n\    ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д !\0"); break;
    }
}

//static void drawNewLine(std::string str)
//{
//	for (uint8_t i = 0; i < str.size(); i++)
//		QmConsoleScreen::oputc(str[i]);
//}



void qmMain()
{
	old_focus = FIRMWARE;
	focus = FIRMWARE;

	QmConsoleScreen::init(2, 2, 2, 2);
	drawMenu();

	//QmConsoleScreen::clearScreen();

	//drawNewLine("abcdefghjklmnopqrstuvwxyz\0");
	//std::string s("ла┬░ла┬▒");
	//drawNewLine(s);
	//drawChar('ла┬░');
	//drawChar('ла┬▒');
//	drawNewLine(symsStr);

//	QmConsoleScreen::oputc('ла┬алњ┬алаРђЎлњ┬░');
//	QmConsoleScreen::oputc('ла┬алњ┬алаРђЎлњ┬Х');
//	QmConsoleScreen::oputc('ла┬алњ┬алаРђЎлњ┬х');
//	QmConsoleScreen::oputc('ла┬алњ┬ала┬ал▓лѓ┬д');
//	QmConsoleScreen::oputc('ла┬алалІла┬алаРђ░');
//	QmConsoleScreen::oputc('-');
//	QmConsoleScreen::oputc('ла┬алњ┬алалјлАЛЎ');

//	drawLine(saghenTitleTestStr);




//	hwboot_test_result_t test_result = hwboot_test_board();
//
//	switch (test_result)
//	{
//		case hwboottestOk:
//		{
//			QmConsoleScreen::oprintf("\r\n ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n    ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\0");
//			break;
//		}
//		case hwboottestErrorExtSram:
//		{
//			QmConsoleScreen::oprintf("\r\nла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n    ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д !\0");
//			while(1); // cannot safely continue !
//			break;
//		}
//		case hwboottestErrorHseClock:
//		{
//			QmConsoleScreen::oprintf("\r\n ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д\r\n     ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д ла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџла┬ал▓лѓлјла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓРёбла┬ал▓лѓ┬д !\0");
//			while(1); // cannot safely continue !
//			break;
//		}
//	}
//
//	if (check_arrows_key_pressed(true, false, false, false))
//		focus = USB_COMPUTER;
//	if (check_arrows_key_pressed(false, true, false, false))
//		focus = SYSTEM_BOOT;
//
//	if (focus != old_focus)
//		drawMenu();
//
//	switch (focus)
//	{
//		case FIRMWARE:
//		{
//			if (!hwboot_check_firmware())
//			{
//				drawFirmwareErrorScreen(1);
//				while(1);
//			}
//			hwboot_jump_firmware();
//			break;
//		}
//		case USB_COMPUTER:
//		{
//			if (!hwboot_check_usbcdc())
//			{
//				drawFirmwareErrorScreen(0);
//				while(1);
//			}
//			drawUsbHostScreen();
//			hwboot_jump_cdc();
//			break;
//		}
//		case SYSTEM_BOOT:
//		{
//			drawSystemBootScreen();
//			hwboot_jump_system_bootloader();
//			break;
//		}
//	}
}



#else

static bool check_bootloader_condition() {
	QmMatrixKeyboard k(platformhwMatrixKeyboard);
	return (k.isKeyPressed(platformhwKeyEnter) && k.isKeyPressed(platformhwKeyBack));
}

static bool check_usbflasher_condition() {
	QmMatrixKeyboard k(platformhwMatrixKeyboard);
	return (k.isKeyPressed(platformhwKeyEnter) && k.isKeyPressed(platformhwKeyLeft));
}

void qmMain() {
	QmConsoleScreen::init(2, 2, 2, 2);

	QmConsoleScreen::oprintf("*** SazhenN bootloader ***\r\n");
#ifndef NDEBUG
	QmConsoleScreen::oprintf("DEBUG BUILD\r\n");
#endif
	QmConsoleScreen::oprintf("Press Enter+Back keys to start system bootloader\r\n\r\n");

	if (check_bootloader_condition()) {
		QmConsoleScreen::oprintf("*** SYSTEM BOOTLOADER\r\n");
		hwboot_jump_system_bootloader();
		/* (ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬ала┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџл▓РђъРђЊла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлњ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёб ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алалЅла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл┐ЛЌлЁла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алАРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░) */
	}

	hwboot_test_result_t test_result = hwboot_test_board();
	switch (test_result) {
	case hwboottestOk:
		QmConsoleScreen::oprintf("Base hardware test: OK\r\n");
		break;
	case hwboottestErrorExtSram:
		QmConsoleScreen::oprintf("*** Ext. mem test FAILED, system terminated !!!\r\n");
		while(1); // cannot safely continue !
		break;
	case hwboottestErrorHseClock:
		QmConsoleScreen::oprintf("*** Ref. clock test FAILED, system terminated !!!\r\n");
		while(1); // cannot safely continue !
		break;
	}

	if (check_usbflasher_condition()) {
		QmConsoleScreen::oprintf("*** USB Flasher\r\n");
		hwboot_jump_usbflasher();
		/* (ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬ала┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџл▓РђъРђЊла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлњ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёб ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алалЅла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл┐ЛЌлЁла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алАРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░) */
	}

	if (!hwboot_check_firmware()) {
		QmConsoleScreen::oprintf("Invalid/missing firmware\r\n");
		while(1);
	}

	QmConsoleScreen::oprintf("\r\n*** Starting firmware...\r\n");
	hwboot_jump_firmware(); // ла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалјл▓лѓЛџла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬ала┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алАРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алалЈ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬ал▓лѓЛЎла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєл▓лѓЛЎлњ┬гла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬ала┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х
	/* (ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬ала┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџл▓РђъРђЊла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђЮла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬╗ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёбла┬ал▓лѓ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬х ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлњ┬дла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓ№┐йла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёб ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаЛъл▓лѓ№┐йла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алалЅла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓРђюла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл▓лѓЛъ ла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблалјл┐ЛЌлЁла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬хла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёбла┬алАРђюла┬ал▓лѓЛџлалєлаРђџл┐ЛЌлЁла┬ал▓лѓРёблалєлаРђџлАРёбла┬ал▓лѓЛџлалјл▓лѓРёбла┬ал▓лѓРёблаРђЎлњ┬░) */
}

#endif


